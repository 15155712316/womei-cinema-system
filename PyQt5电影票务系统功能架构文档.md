# PyQt5ç”µå½±ç¥¨åŠ¡ç®¡ç†ç³»ç»Ÿ - åŠŸèƒ½æ¶æ„æ–‡æ¡£

## ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ

**ä¸»æ–‡ä»¶**ï¼š`main_modular.py` (4425è¡Œ)  
**æ ¸å¿ƒç±»**ï¼š`ModularCinemaMainWindow` (ç»§æ‰¿è‡ªQMainWindow)  
**æ¶æ„æ¨¡å¼**ï¼šæ¨¡å—åŒ–æ’ä»¶æ¶æ„  
**UIæ¡†æ¶**ï¼šPyQt5  

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„åˆ†æ

### 1. æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ModularCinemaMainWindow                  â”‚
â”‚                     (ä¸»çª—å£æ§åˆ¶å™¨)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ è´¦å·ç®¡ç†æ¨¡å— â”‚  â”‚ Tabç®¡ç†æ¨¡å—  â”‚  â”‚ åº§ä½è®¢å•æ¨¡å— â”‚        â”‚
â”‚  â”‚AccountWidgetâ”‚  â”‚TabManager   â”‚  â”‚SeatOrder    â”‚        â”‚
â”‚  â”‚             â”‚  â”‚Widget       â”‚  â”‚Widget       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    ä¸šåŠ¡æœåŠ¡å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ è®¤è¯æœåŠ¡     â”‚  â”‚ å½±é™¢ç®¡ç†     â”‚  â”‚ ä¼šå‘˜æœåŠ¡     â”‚        â”‚
â”‚  â”‚AuthService  â”‚  â”‚CinemaManagerâ”‚  â”‚MemberServiceâ”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    APIæ¥å£å±‚                               â”‚
â”‚  è®¢å•API â”‚ æ”¯ä»˜API â”‚ å½±é™¢API â”‚ ä¼šå‘˜API â”‚ åˆ¸API â”‚ è´¦å·API   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ¨¡å—ä¾èµ–å…³ç³»

- **UIæ¡†æ¶ä¾èµ–**ï¼š49ä¸ªPyQt5ç›¸å…³å¯¼å…¥
- **ä¸šåŠ¡æœåŠ¡ä¾èµ–**ï¼š44ä¸ªservicesæ¨¡å—å¯¼å…¥
- **UIç»„ä»¶ä¾èµ–**ï¼š18ä¸ªuiç»„ä»¶å¯¼å…¥
- **ç³»ç»Ÿä¾èµ–**ï¼š43ä¸ªç³»ç»Ÿæ¨¡å—å¯¼å…¥

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åˆ†æ

### 1. ç”¨æˆ·è®¤è¯ä¸ç™»å½• (Authentication)

#### å…³é”®æ–¹æ³•
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° |
|--------|----------|----------|
| `_start_auth_check` | 483-495 | å¯åŠ¨ç”¨æˆ·è®¤è¯æ£€æŸ¥ |
| `_on_user_login_success` | 498-525 | å¤„ç†ç™»å½•æˆåŠŸäº‹ä»¶ |
| `_show_main_window_after_login` | 527-553 | ç™»å½•åæ˜¾ç¤ºä¸»çª—å£ |
| `_restart_login` | 667-680 | é‡æ–°å¯åŠ¨ç™»å½•æµç¨‹ |
| `cinema_account_login_api` | 1138-1151 | å½±é™¢è´¦å·ç™»å½•API |

#### ä¸šåŠ¡æµç¨‹
```
ç”¨æˆ·å¯åŠ¨ â†’ æ˜¾ç¤ºç™»å½•çª—å£ â†’ éªŒè¯ç”¨æˆ·ä¿¡æ¯ â†’ ç™»å½•æˆåŠŸ â†’ æ˜¾ç¤ºä¸»çª—å£ â†’ è‡ªåŠ¨é€‰æ‹©é»˜è®¤å½±é™¢å’Œè´¦å·
```

### 2. å½±é™¢ä¸è´¦å·ç®¡ç† (Cinema & Account Management)

#### å…³é”®æ–¹æ³•
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° |
|--------|----------|----------|
| `_trigger_default_cinema_selection` | 555-587 | æ™ºèƒ½é»˜è®¤é€‰æ‹©å½±é™¢ |
| `_auto_select_cinema_account` | 589-636 | è‡ªåŠ¨é€‰æ‹©å½±é™¢å…³è”è´¦å· |
| `_on_account_selected` | 695-702 | è´¦å·é€‰æ‹©å¤„ç† |
| `_on_cinema_selected` | 708-733 | å½±é™¢é€‰æ‹©å¤„ç† |
| `_get_cinema_info_by_name` | 1200-1237 | æ ¹æ®åç§°è·å–å½±é™¢ä¿¡æ¯ |

#### æ•°æ®æµå‘
```
å½±é™¢åˆ—è¡¨åŠ è½½ â†’ é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªå½±é™¢ â†’ æŸ¥æ‰¾å…³è”è´¦å· â†’ è®¾ç½®å½“å‰è´¦å· â†’ æ›´æ–°UIæ˜¾ç¤º
```

### 3. åº§ä½é€‰æ‹©ä¸è®¢å•ç®¡ç† (Seat Selection & Order Management)

#### å…³é”®æ–¹æ³•
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° |
|--------|----------|----------|
| `_on_session_selected` | 1347-1369 | åœºæ¬¡é€‰æ‹©å¤„ç† |
| `_load_seat_map` | 1436-1500 | åŠ è½½åº§ä½å›¾æ•°æ® |
| `_on_order_submitted` | 735-785 | å¤„ç†è®¢å•æäº¤ |
| `show_order_detail` | 1042-1044 | æ˜¾ç¤ºè®¢å•è¯¦æƒ… |
| `refresh_order_list` | 844-861 | åˆ·æ–°è®¢å•åˆ—è¡¨ |

#### åº§ä½é€‰æ‹©æµç¨‹
```
é€‰æ‹©åœºæ¬¡ â†’ åŠ è½½åº§ä½å›¾ â†’ ç”¨æˆ·é€‰æ‹©åº§ä½ â†’ æäº¤è®¢å• â†’ æ˜¾ç¤ºè®¢å•è¯¦æƒ…
```

### 4. æ”¯ä»˜ç³»ç»Ÿ (Payment System)

#### å…³é”®æ–¹æ³•
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° |
|--------|----------|----------|
| `_init_enhanced_payment_system` | 129-149 | åˆå§‹åŒ–å¢å¼ºæ”¯ä»˜ç³»ç»Ÿ |
| `on_one_click_pay` | 863-1040 | ä¸€é”®æ”¯ä»˜å¤„ç† |
| `_get_member_info` | 1062-1131 | è·å–ä¼šå‘˜ä¿¡æ¯ |
| `on_bind_coupons` | 787-842 | ç»‘å®šåˆ¸å¤„ç† |

#### æ”¯ä»˜æµç¨‹
```
æ£€æŸ¥è®¢å• â†’ éªŒè¯è´¦å· â†’ æ£€æµ‹å¯†ç ç­–ç•¥ â†’ è·å–åˆ¸ä¿¡æ¯ â†’ è®¡ç®—æ”¯ä»˜é‡‘é¢ â†’ è°ƒç”¨æ”¯ä»˜API â†’ è·å–å–ç¥¨ç 
```

### 5. ä¼šå‘˜ä¸åˆ¸ç®¡ç† (Member & Coupon Management)

#### å…³é”®åŠŸèƒ½
- **ä¼šå‘˜å¡æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ˜¯å¦æœ‰ä¼šå‘˜å¡
- **å¯†ç ç­–ç•¥**ï¼šåŠ¨æ€æ£€æµ‹æ˜¯å¦éœ€è¦ä¼šå‘˜å¡å¯†ç 
- **åˆ¸ç»‘å®š**ï¼šæ‰¹é‡ç»‘å®šä¼˜æƒ åˆ¸
- **åˆ¸æ”¯ä»˜**ï¼šæ”¯æŒåˆ¸+ä¼šå‘˜å¡æ··åˆæ”¯ä»˜

---

## ğŸ”— ä¿¡å·ä¸äº‹ä»¶ç³»ç»Ÿ

### 1. ä¸»çª—å£ä¿¡å·å®šä¹‰
```python
login_success = pyqtSignal(dict)  # ç™»å½•æˆåŠŸä¿¡å·
```

### 2. ä¿¡å·è¿æ¥æ¶æ„
| ä¿¡å·æº | ä¿¡å·å | å¤„ç†æ–¹æ³• | åŠŸèƒ½ |
|--------|--------|----------|------|
| AccountWidget | account_selected | _on_account_selected | è´¦å·é€‰æ‹© |
| TabManagerWidget | cinema_selected | _on_cinema_selected | å½±é™¢é€‰æ‹© |
| TabManagerWidget | order_submitted | _on_order_submitted | è®¢å•æäº¤ |
| TabManagerWidget | session_selected | _on_session_selected | åœºæ¬¡é€‰æ‹© |
| å…¨å±€äº‹ä»¶æ€»çº¿ | user_login_success | _on_global_login_success | å…¨å±€ç™»å½•æˆåŠŸ |

### 3. å…¨å±€äº‹ä»¶æ€»çº¿
```python
event_bus.user_login_success.connect(self._on_global_login_success)
event_bus.account_changed.connect(self._on_global_account_changed)
event_bus.cinema_selected.connect(self._on_global_cinema_selected)
event_bus.order_created.connect(self._on_global_order_created)
event_bus.order_paid.connect(self._on_global_order_paid)
```

---

## ğŸ¨ UIç»„ä»¶æ¶æ„

### 1. ä¸»çª—å£å¸ƒå±€ (1500x900)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸»çª—å£ (1500x900)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å·¦æ       â”‚           ä¸­æ               â”‚      å³æ        â”‚
â”‚  (20%)      â”‚          (60%)              â”‚     (20%)       â”‚
â”‚             â”‚                             â”‚                 â”‚
â”‚ è´¦å·ç®¡ç†æ¨¡å— â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   å–ç¥¨ç åŒº      â”‚
â”‚AccountWidgetâ”‚  â”‚    Tabç®¡ç†æ¨¡å—          â”‚ â”‚  (45%)          â”‚
â”‚             â”‚  â”‚  TabManagerWidget       â”‚ â”‚                 â”‚
â”‚             â”‚  â”‚      (38%)              â”‚ â”‚                 â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                 â”‚
â”‚             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚             â”‚  â”‚    åº§ä½é€‰æ‹©åŒºåŸŸ          â”‚ â”‚ â”‚ è®¢å•è¯¦æƒ…åŒº   â”‚ â”‚
â”‚             â”‚  â”‚   (åº§ä½å›¾æ˜¾ç¤º)           â”‚ â”‚ â”‚   (55%)     â”‚ â”‚
â”‚             â”‚  â”‚      (62%)              â”‚ â”‚ â”‚             â”‚ â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. UIç»„ä»¶ç»Ÿè®¡
- **æ€»UIç»„ä»¶**ï¼š15ä¸ª
- **æŒ‰é’®ç»„ä»¶**ï¼š3ä¸ª (å¤åˆ¶è·¯å¾„ã€å¤åˆ¶å›¾ç‰‡ã€ä¸€é”®æ”¯ä»˜)
- **æ ‡ç­¾ç»„ä»¶**ï¼š2ä¸ª (åº§ä½å ä½ç¬¦ã€æ‰‹æœºå·æ˜¾ç¤º)
- **è¾“å…¥ç»„ä»¶**ï¼š2ä¸ª (åº§ä½è¾“å…¥ã€è®¢å•è¯¦æƒ…æ–‡æœ¬)
- **å¸ƒå±€ç»„ä»¶**ï¼š5ä¸ª (ä¸»å¸ƒå±€ã€ä¸­æ å¸ƒå±€ç­‰)
- **å…¶ä»–ç»„ä»¶**ï¼š3ä¸ª (åˆ†ç»„æ¡†ã€æ˜¾ç¤ºåŒºåŸŸç­‰)

---

## ğŸ“¡ APIè°ƒç”¨æ¶æ„

### 1. APIè°ƒç”¨ç»Ÿè®¡
- **æ€»APIè°ƒç”¨**ï¼š68ä¸ª
- **è®¢å•API**ï¼š25ä¸ª (37%)
- **æ”¯ä»˜API**ï¼š15ä¸ª (22%)
- **ä¼šå‘˜API**ï¼š12ä¸ª (18%)
- **å½±é™¢API**ï¼š8ä¸ª (12%)
- **åˆ¸API**ï¼š5ä¸ª (7%)
- **è®¤è¯API**ï¼š3ä¸ª (4%)

### 2. æ ¸å¿ƒAPIæ¥å£
| APIç±»å‹ | ä¸»è¦æ¥å£ | åŠŸèƒ½æè¿° |
|---------|----------|----------|
| è®¢å•API | create_order, get_order_detail | åˆ›å»ºè®¢å•ã€è·å–è®¢å•è¯¦æƒ… |
| æ”¯ä»˜API | pay_order, get_order_qrcode_api | è®¢å•æ”¯ä»˜ã€è·å–å–ç¥¨ç  |
| ä¼šå‘˜API | getMemberInfo | è·å–ä¼šå‘˜ä¿¡æ¯ |
| å½±é™¢API | get_films, get_plan_seat_info | è·å–å½±ç‰‡ã€åº§ä½ä¿¡æ¯ |
| åˆ¸API | get_coupons_by_order, bind_coupon | è·å–å¯ç”¨åˆ¸ã€ç»‘å®šåˆ¸ |

---

## ğŸ”„ ä¸šåŠ¡æµç¨‹é“¾è·¯

### 1. å®Œæ•´è´­ç¥¨æµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·å¯åŠ¨] --> B[ç™»å½•éªŒè¯]
    B --> C[æ˜¾ç¤ºä¸»çª—å£]
    C --> D[è‡ªåŠ¨é€‰æ‹©å½±é™¢]
    D --> E[é€‰æ‹©è´¦å·]
    E --> F[é€‰æ‹©å½±ç‰‡]
    F --> G[é€‰æ‹©åœºæ¬¡]
    G --> H[åŠ è½½åº§ä½å›¾]
    H --> I[é€‰æ‹©åº§ä½]
    I --> J[æäº¤è®¢å•]
    J --> K[é€‰æ‹©ä¼˜æƒ åˆ¸]
    K --> L[ä¸€é”®æ”¯ä»˜]
    L --> M[è·å–å–ç¥¨ç ]
    M --> N[å®Œæˆè´­ç¥¨]
```

### 2. æ•°æ®æµå‘åˆ†æ
```
ç”¨æˆ·è¾“å…¥ â†’ UIç»„ä»¶ â†’ äº‹ä»¶å¤„ç† â†’ ä¸šåŠ¡é€»è¾‘ â†’ APIè°ƒç”¨ â†’ æ•°æ®å¤„ç† â†’ UIæ›´æ–°
```

---

## ğŸ› ï¸ æŠ€æœ¯ç‰¹æ€§

### 1. æ¶æ„ä¼˜åŠ¿
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¸…æ™°çš„æ¨¡å—åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤
- **æ’ä»¶æ¶æ„**ï¼šæ”¯æŒåŠŸèƒ½æ‰©å±•
- **äº‹ä»¶é©±åŠ¨**ï¼šåŸºäºä¿¡å·æ§½çš„æ¾è€¦åˆè®¾è®¡
- **ç»Ÿä¸€API**ï¼šæ ‡å‡†åŒ–çš„APIè°ƒç”¨æ¥å£

### 2. ä»£ç è´¨é‡
- **æ–¹æ³•æ•°é‡**ï¼š106ä¸ªæ–¹æ³•ï¼Œå¹³å‡42è¡Œ/æ–¹æ³•
- **ä¸šåŠ¡é€»è¾‘è¦†ç›–**ï¼š93ä¸ªä¸šåŠ¡ç›¸å…³æ–¹æ³• (88%)
- **äº‹ä»¶å¤„ç†**ï¼šå®Œå–„çš„äº‹ä»¶å¤„ç†æœºåˆ¶
- **é”™è¯¯å¤„ç†**ï¼šå…¨é¢çš„å¼‚å¸¸å¤„ç†å’Œé™çº§æ–¹æ¡ˆ

### 3. æ€§èƒ½ç‰¹æ€§
- **å¼‚æ­¥å¤„ç†**ï¼šä½¿ç”¨QTimeré¿å…UIé˜»å¡
- **æ™ºèƒ½ç¼“å­˜**ï¼šä¼šå‘˜ä¿¡æ¯å’Œå½±é™¢æ•°æ®ç¼“å­˜
- **å»¶è¿ŸåŠ è½½**ï¼šåº§ä½å›¾æŒ‰éœ€åŠ è½½
- **èµ„æºä¼˜åŒ–**ï¼šå›¾ç‰‡å’Œæ•°æ®çš„å†…å­˜ç®¡ç†

---

## ğŸ“‹ æ€»ç»“

PyQt5ç”µå½±ç¥¨åŠ¡ç®¡ç†ç³»ç»Ÿé‡‡ç”¨äº†ç°ä»£åŒ–çš„æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **å®Œæ•´çš„ä¸šåŠ¡è¦†ç›–**ï¼šä»ç”¨æˆ·è®¤è¯åˆ°æ”¯ä»˜å®Œæˆçš„å…¨æµç¨‹æ”¯æŒ
2. **ä¼˜ç§€çš„æ¶æ„è®¾è®¡**ï¼šæ¨¡å—åŒ–ã€æ’ä»¶åŒ–ã€äº‹ä»¶é©±åŠ¨çš„è®¾è®¡æ¨¡å¼
3. **ä¸°å¯Œçš„åŠŸèƒ½ç‰¹æ€§**ï¼šæ”¯æŒä¼šå‘˜å¡ã€ä¼˜æƒ åˆ¸ã€å¤šç§æ”¯ä»˜æ–¹å¼
4. **è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ**ï¼šæ™ºèƒ½é»˜è®¤é€‰æ‹©ã€ä¸€é”®æ”¯ä»˜ã€å®æ—¶çŠ¶æ€æ›´æ–°
5. **é«˜è´¨é‡çš„ä»£ç **ï¼šæ¸…æ™°çš„ç»“æ„ã€å®Œå–„çš„é”™è¯¯å¤„ç†ã€è¯¦ç»†çš„æ–‡æ¡£

è¯¥ç³»ç»Ÿä¸ºç”µå½±ç¥¨åŠ¡ç®¡ç†æä¾›äº†ä¸€ä¸ªç¨³å®šã€é«˜æ•ˆã€æ˜“æ‰©å±•çš„è§£å†³æ–¹æ¡ˆã€‚

---

## ğŸ“‹ è¯¦ç»†åŠŸèƒ½æ¨¡å—æ¸…å•

### 1. åˆå§‹åŒ–æ¨¡å— (Initialization)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | å…³é”®ç‰¹æ€§ |
|--------|----------|----------|----------|
| `__init__` | 65-127 | ä¸»çª—å£åˆå§‹åŒ– | æœåŠ¡åˆå§‹åŒ–ã€UIåˆ›å»ºã€ä¿¡å·è¿æ¥ |
| `_init_enhanced_payment_system` | 129-149 | å¢å¼ºæ”¯ä»˜ç³»ç»Ÿåˆå§‹åŒ– | å¯†ç ç­–ç•¥ã€APIå®¢æˆ·ç«¯ |
| `_init_ui` | 151-193 | ç”¨æˆ·ç•Œé¢åˆå§‹åŒ– | ä¸‰æ å¸ƒå±€ã€ç»„ä»¶åˆ›å»º |

### 2. UIåˆ›å»ºæ¨¡å— (UI Creation)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | å…³é”®ç‰¹æ€§ |
|--------|----------|----------|----------|
| `_create_seat_area` | 197-238 | åˆ›å»ºåº§ä½é€‰æ‹©åŒºåŸŸ | åº§ä½å›¾æ˜¾ç¤ºã€å ä½ç¬¦ |
| `_create_right_area` | 240-390 | åˆ›å»ºå³æ åŒºåŸŸ | å–ç¥¨ç åŒºã€è®¢å•è¯¦æƒ…åŒº |
| `_create_new_login_window` | 682-691 | åˆ›å»ºç™»å½•çª—å£ | ç™»å½•ç•Œé¢ã€ä¿¡å·è¿æ¥ |

### 3. äº‹ä»¶å¤„ç†æ¨¡å— (Event Handling)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | ä¸šåŠ¡ç±»å‹ |
|--------|----------|----------|----------|
| `_on_user_login_success` | 498-525 | ç”¨æˆ·ç™»å½•æˆåŠŸå¤„ç† | è®¤è¯ |
| `_on_account_selected` | 695-702 | è´¦å·é€‰æ‹©å¤„ç† | è´¦å·ç®¡ç† |
| `_on_cinema_selected` | 708-733 | å½±é™¢é€‰æ‹©å¤„ç† | å½±é™¢ç®¡ç† |
| `_on_order_submitted` | 735-785 | è®¢å•æäº¤å¤„ç† | è®¢å•ç®¡ç† |
| `_on_session_selected` | 1347-1369 | åœºæ¬¡é€‰æ‹©å¤„ç† | åº§ä½é€‰æ‹© |
| `_on_copy_path` | 392-406 | å¤åˆ¶è·¯å¾„äº‹ä»¶ | UIäº¤äº’ |
| `_on_copy_image` | 408-437 | å¤åˆ¶å›¾ç‰‡äº‹ä»¶ | UIäº¤äº’ |

### 4. ä¸šåŠ¡é€»è¾‘æ¨¡å— (Business Logic)

#### 4.1 è®¢å•ç®¡ç†
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | APIè°ƒç”¨ |
|--------|----------|----------|---------|
| `refresh_order_list` | 844-861 | åˆ·æ–°è®¢å•åˆ—è¡¨ | get_order_list |
| `show_order_detail` | 1042-1044 | æ˜¾ç¤ºè®¢å•è¯¦æƒ… | - |
| `_cancel_unpaid_orders` | 1046-1060 | å–æ¶ˆæœªæ”¯ä»˜è®¢å• | cancel_all_unpaid_orders |

#### 4.2 æ”¯ä»˜ç®¡ç†
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | APIè°ƒç”¨ |
|--------|----------|----------|---------|
| `on_one_click_pay` | 863-1040 | ä¸€é”®æ”¯ä»˜å¤„ç† | pay_order, get_order_detail |
| `on_bind_coupons` | 787-842 | ç»‘å®šåˆ¸å¤„ç† | bind_coupon |

#### 4.3 ä¼šå‘˜ç®¡ç†
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | APIè°ƒç”¨ |
|--------|----------|----------|---------|
| `_get_member_info` | 1062-1131 | è·å–ä¼šå‘˜ä¿¡æ¯ | api_get (getMemberInfo) |

### 5. æ•°æ®å¤„ç†æ¨¡å— (Data Processing)

#### 5.1 æ•°æ®è·å–
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | æ•°æ®æº |
|--------|----------|----------|--------|
| `_get_cinema_info_by_name` | 1200-1237 | æ ¹æ®åç§°è·å–å½±é™¢ä¿¡æ¯ | cinema_manager |
| `_load_movies_for_cinema` | 1239-1276 | ä¸ºå½±é™¢åŠ è½½ç”µå½±åˆ—è¡¨ | film_service |
| `_load_seat_map` | 1436-1500 | åŠ è½½åº§ä½å›¾æ•°æ® | get_plan_seat_info |

#### 5.2 æ•°æ®æŒä¹…åŒ–
| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | å­˜å‚¨æ–¹å¼ |
|--------|----------|----------|----------|
| `_save_account_data` | 1192-1198 | ä¿å­˜è´¦å·æ•°æ® | save_account |
| `_update_tab_cinema_selection` | 638-653 | æ›´æ–°Tabå½±é™¢é€‰æ‹© | UIçŠ¶æ€ |

### 6. ä¿¡å·è¿æ¥æ¨¡å— (Signal Connection)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | è¿æ¥ç±»å‹ |
|--------|----------|----------|----------|
| `_connect_signals` | 450-471 | è¿æ¥ä¿¡å·æ§½ | ç»„ä»¶é—´ä¿¡å· |
| `_connect_global_events` | 473-481 | è¿æ¥å…¨å±€äº‹ä»¶ | å…¨å±€äº‹ä»¶æ€»çº¿ |

### 7. UIæ˜¾ç¤ºæ¨¡å— (UI Display)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | æ˜¾ç¤ºå†…å®¹ |
|--------|----------|----------|----------|
| `_show_main_window_after_login` | 527-553 | ç™»å½•åæ˜¾ç¤ºä¸»çª—å£ | ä¸»ç•Œé¢ |
| `_show_order_detail` | 1278-1292 | æ˜¾ç¤ºè®¢å•è¯¦æƒ… | è®¢å•ä¿¡æ¯ |
| `_show_qr_code` | 1294-1311 | æ˜¾ç¤ºå–ç¥¨ç  | äºŒç»´ç  |
| `_safe_update_seat_area` | 1371-1400 | å®‰å…¨æ›´æ–°åº§ä½åŒºåŸŸ | åº§ä½å›¾/å ä½ç¬¦ |

### 8. å·¥å…·æ–¹æ³•æ¨¡å— (Utility Methods)

| æ–¹æ³•å | è¡Œå·èŒƒå›´ | åŠŸèƒ½æè¿° | ç”¨é€” |
|--------|----------|----------|------|
| `center_window` | 655-665 | çª—å£å±…ä¸­æ˜¾ç¤º | UIå¸ƒå±€ |
| `_restart_login` | 667-680 | é‡å¯ç™»å½•æµç¨‹ | é”™è¯¯æ¢å¤ |
| `_trigger_default_cinema_selection` | 555-587 | æ™ºèƒ½é»˜è®¤é€‰æ‹© | ç”¨æˆ·ä½“éªŒ |
| `_auto_select_cinema_account` | 589-636 | è‡ªåŠ¨é€‰æ‹©è´¦å· | æ™ºèƒ½åŒ– |
| `_refresh_account_dependent_data` | 1155-1190 | åˆ·æ–°ä¾èµ–æ•°æ® | æ•°æ®åŒæ­¥ |

---

## ğŸ” æ–¹æ³•åˆ†ç±»ç»Ÿè®¡

### æŒ‰åŠŸèƒ½ç±»å‹åˆ†ç±»
- **äº‹ä»¶å¤„ç†** (Event Handler): 23ä¸ªæ–¹æ³• (22%)
- **ä¸šåŠ¡é€»è¾‘** (Business Logic): 18ä¸ªæ–¹æ³• (17%)
- **æ•°æ®è·å–** (Data Retrieval): 15ä¸ªæ–¹æ³• (14%)
- **UIåˆ›å»º** (UI Creation): 12ä¸ªæ–¹æ³• (11%)
- **åˆå§‹åŒ–** (Initialization): 10ä¸ªæ–¹æ³• (9%)
- **å·¥å…·æ–¹æ³•** (Utility): 28ä¸ªæ–¹æ³• (27%)

### æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ†ç±»
- **è®¤è¯ç›¸å…³**: 8ä¸ªæ–¹æ³•
- **è®¢å•ç®¡ç†**: 15ä¸ªæ–¹æ³•
- **æ”¯ä»˜å¤„ç†**: 12ä¸ªæ–¹æ³•
- **åº§ä½é€‰æ‹©**: 8ä¸ªæ–¹æ³•
- **å½±é™¢ç®¡ç†**: 10ä¸ªæ–¹æ³•
- **ä¼šå‘˜ç®¡ç†**: 6ä¸ªæ–¹æ³•
- **UIäº¤äº’**: 47ä¸ªæ–¹æ³•

---

## ğŸ¯ å…³é”®ä¸šåŠ¡é“¾è·¯è¯¦è§£

### 1. ç”¨æˆ·ç™»å½•é“¾è·¯
```
_start_auth_check â†’ LoginWindow.show â†’ _on_user_login_success â†’
_show_main_window_after_login â†’ _trigger_default_cinema_selection â†’
_auto_select_cinema_account
```

### 2. è®¢å•åˆ›å»ºé“¾è·¯
```
_on_session_selected â†’ _load_seat_map â†’ ç”¨æˆ·é€‰æ‹©åº§ä½ â†’
_on_order_submitted â†’ on_submit_order â†’ create_order API â†’
_show_order_detail
```

### 3. æ”¯ä»˜å¤„ç†é“¾è·¯
```
on_one_click_pay â†’ validate_member_password_policy â†’
_get_member_info â†’ è®¡ç®—æ”¯ä»˜é‡‘é¢ â†’ pay_order API â†’
get_order_detail API â†’ _get_ticket_code_after_payment
```

### 4. åº§ä½é€‰æ‹©é“¾è·¯
```
å½±é™¢é€‰æ‹© â†’ å½±ç‰‡é€‰æ‹© â†’ åœºæ¬¡é€‰æ‹© â†’ _on_session_selected â†’
_load_seat_map â†’ get_plan_seat_info API â†’ _display_seat_map â†’
ç”¨æˆ·ç‚¹å‡»åº§ä½ â†’ åº§ä½çŠ¶æ€æ›´æ–°
```

è¿™ä¸ªè¯¦ç»†çš„åŠŸèƒ½æ¨¡å—æ¸…å•ä¸ºç†è§£å’Œç»´æŠ¤ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„å‚è€ƒæŒ‡å—ã€‚
