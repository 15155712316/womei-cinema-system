# PyQt5ç”µå½±ç¥¨åŠ¡ç®¡ç†ç³»ç»Ÿ - ä»£ç è´¨é‡å’Œæ¶æ„åˆ†ææŠ¥å‘Š

## ğŸ“Š åˆ†ææ¦‚è§ˆ

**åˆ†ææ—¶é—´**ï¼š2024å¹´12æœˆ  
**é¡¹ç›®è§„æ¨¡**ï¼šçº¦50ä¸ªPythonæ–‡ä»¶ï¼Œ15000+è¡Œä»£ç   
**ä¸»è¦æŠ€æœ¯æ ˆ**ï¼šPyQt5, Python 3.8+, RESTful API  

---

## ğŸ” 1. ä»£ç è´¨é‡åˆ†æ

### 1.1 æœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜1ï¼šmain_modular.py å¯¼å…¥å†—ä½™**
- **ä½ç½®**ï¼š`main_modular.py:50`
- **é—®é¢˜**ï¼š`import json, os, time, traceback` éƒ¨åˆ†å¯¼å…¥æœªä½¿ç”¨
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# ä¿®æ”¹å‰
import json, os, time, traceback

# ä¿®æ”¹å
import time, traceback  # ç§»é™¤æœªä½¿ç”¨çš„json, os
```
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜å¯åŠ¨é€Ÿåº¦

**é—®é¢˜2ï¼šé‡å¤å¯¼å…¥é—®é¢˜**
- **ä½ç½®**ï¼šå¤šä¸ªæ–‡ä»¶å­˜åœ¨é‡å¤å¯¼å…¥
- **é—®é¢˜**ï¼š`from PyQt5.QtCore import Qt` åœ¨å¤šå¤„é‡å¤å¯¼å…¥
- **ä¸¥é‡ç¨‹åº¦**ï¼šä½
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºç»Ÿä¸€çš„å¯¼å…¥æ¨¡å—
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜ä»£ç ä¸€è‡´æ€§

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜3ï¼šæœªä½¿ç”¨çš„å˜é‡**
- **ä½ç½®**ï¼š`main_modular.py:83-84`
- **é—®é¢˜**ï¼š`self.show_debug = False` å’Œ `self.last_priceinfo = {}` æœªè¢«ä½¿ç”¨
- **ä¸¥é‡ç¨‹åº¦**ï¼šä½
- **è§£å†³æ–¹æ¡ˆ**ï¼šç§»é™¤æˆ–å®ç°ç›¸å…³åŠŸèƒ½
- **é¢„æœŸæ•ˆæœ**ï¼šä»£ç æ¸…æ´åº¦æå‡

### 1.2 ä»£ç é‡å¤åˆ†æ

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜4ï¼šå¼‚å¸¸å¤„ç†æ¨¡å¼é‡å¤**
- **ä½ç½®**ï¼šå¤šä¸ªæœåŠ¡æ–‡ä»¶
- **é—®é¢˜**ï¼šç›¸åŒçš„try-catchæ¨¡å¼é‡å¤å‡ºç°
```python
# é‡å¤æ¨¡å¼
try:
    # APIè°ƒç”¨
    result = api_call()
    return result
except Exception as e:
    print(f"é”™è¯¯: {e}")
    import traceback
    traceback.print_exc()
    return None
```
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†è£…é¥°å™¨
```python
def api_exception_handler(func):
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            logger.error(f"{func.__name__} é”™è¯¯: {e}")
            return {"success": False, "error": str(e)}
    return wrapper
```
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘ä»£ç é‡å¤50%ï¼Œæé«˜é”™è¯¯å¤„ç†ä¸€è‡´æ€§

**é—®é¢˜5ï¼šAPIè°ƒç”¨æ¨¡å¼é‡å¤**
- **ä½ç½®**ï¼š`services/order_api.py`, `services/cinema_manager.py`
- **é—®é¢˜**ï¼šç›¸ä¼¼çš„APIè°ƒç”¨å’Œå‚æ•°éªŒè¯é€»è¾‘
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºåŸºç¡€APIå®¢æˆ·ç«¯ç±»
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘ä»£ç é‡å¤60%

### 1.3 å¼‚å¸¸å¤„ç†å®Œæ•´æ€§

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜6ï¼šç¼ºå°‘å…·ä½“å¼‚å¸¸ç±»å‹å¤„ç†**
- **ä½ç½®**ï¼š`services/auth_service.py:188`
- **é—®é¢˜**ï¼šä½¿ç”¨é€šç”¨Exceptionæ•è·æ‰€æœ‰å¼‚å¸¸
```python
# é—®é¢˜ä»£ç 
except Exception as e:
    return False, f"ç™»å½•å¼‚å¸¸: {str(e)}", None
```
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# æ”¹è¿›å
except requests.exceptions.ConnectionError:
    return False, "ç½‘ç»œè¿æ¥å¤±è´¥", None
except requests.exceptions.Timeout:
    return False, "è¯·æ±‚è¶…æ—¶", None
except ValueError as e:
    return False, f"å‚æ•°é”™è¯¯: {e}", None
except Exception as e:
    logger.error(f"æœªçŸ¥é”™è¯¯: {e}")
    return False, "ç³»ç»Ÿé”™è¯¯", None
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜é”™è¯¯è¯Šæ–­å‡†ç¡®æ€§

**é—®é¢˜7ï¼šç¼ºå°‘èµ„æºæ¸…ç†**
- **ä½ç½®**ï¼šå¤šä¸ªUIç»„ä»¶
- **é—®é¢˜**ï¼šæ²¡æœ‰æ­£ç¡®å®ç°èµ„æºæ¸…ç†
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šå®ç°ä¸Šä¸‹æ–‡ç®¡ç†å™¨æˆ–ææ„å‡½æ•°
- **é¢„æœŸæ•ˆæœ**ï¼šé˜²æ­¢å†…å­˜æ³„æ¼

### 1.4 ç±»å‹æ³¨è§£å’Œæ–‡æ¡£å­—ç¬¦ä¸²

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜8ï¼šç±»å‹æ³¨è§£ä¸å®Œæ•´**
- **ä½ç½®**ï¼šçº¦60%çš„å‡½æ•°ç¼ºå°‘ç±»å‹æ³¨è§£
- **é—®é¢˜**ï¼šå½±å“ä»£ç å¯è¯»æ€§å’ŒIDEæ”¯æŒ
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# æ”¹è¿›å‰
def create_order(params):
    return api_post('createOrder', params)

# æ”¹è¿›å
def create_order(params: Dict[str, Any]) -> Dict[str, Any]:
    """åˆ›å»ºè®¢å•
    
    Args:
        params: è®¢å•å‚æ•°å­—å…¸
        
    Returns:
        APIå“åº”ç»“æœå­—å…¸
        
    Raises:
        ValueError: å‚æ•°éªŒè¯å¤±è´¥
        ConnectionError: ç½‘ç»œè¿æ¥å¤±è´¥
    """
    return api_post('createOrder', params)
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜ä»£ç å¯ç»´æŠ¤æ€§30%

---

## âš¡ 2. æ€§èƒ½ä¼˜åŒ–æœºä¼š

### 2.1 APIè°ƒç”¨ä¼˜åŒ–

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜9ï¼šé‡å¤APIè°ƒç”¨**
- **ä½ç½®**ï¼š`main_modular.py:1690-1705`
- **é—®é¢˜**ï¼šåº§ä½å›¾åŠ è½½æ—¶é‡å¤è°ƒç”¨ç›¸åŒAPI
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šå®ç°APIå“åº”ç¼“å­˜
```python
class APICache:
    def __init__(self, ttl=300):  # 5åˆ†é’Ÿç¼“å­˜
        self.cache = {}
        self.ttl = ttl
    
    def get_or_fetch(self, key, fetch_func):
        if key in self.cache:
            data, timestamp = self.cache[key]
            if time.time() - timestamp < self.ttl:
                return data
        
        data = fetch_func()
        self.cache[key] = (data, time.time())
        return data
```
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘APIè°ƒç”¨50%ï¼Œæå‡å“åº”é€Ÿåº¦

**é—®é¢˜10ï¼šåŒæ­¥APIè°ƒç”¨é˜»å¡UI**
- **ä½ç½®**ï¼šå¤šä¸ªAPIè°ƒç”¨ç‚¹
- **é—®é¢˜**ï¼šé•¿æ—¶é—´APIè°ƒç”¨å¯¼è‡´UIå†»ç»“
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨QThreadè¿›è¡Œå¼‚æ­¥è°ƒç”¨
- **é¢„æœŸæ•ˆæœ**ï¼šæå‡ç”¨æˆ·ä½“éªŒï¼ŒUIå“åº”æ€§æé«˜80%

### 2.2 å†…å­˜ä½¿ç”¨ä¼˜åŒ–

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜11ï¼šå¤§é‡æ•°æ®ç¼“å­˜**
- **ä½ç½®**ï¼š`main_modular.py:79`
- **é—®é¢˜**ï¼š`self.coupons_data = []` å¯èƒ½ç¼“å­˜å¤§é‡æ•°æ®
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šå®ç°LRUç¼“å­˜å’Œæ•°æ®åˆ†é¡µ
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘å†…å­˜ä½¿ç”¨40%

### 2.3 UIå“åº”æ€§ä¼˜åŒ–

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜12ï¼šåº§ä½å›¾æ¸²æŸ“æ€§èƒ½**
- **ä½ç½®**ï¼šåº§ä½å›¾ç»„ä»¶
- **é—®é¢˜**ï¼šå¤§å‹å½±å…åº§ä½å›¾æ¸²æŸ“ç¼“æ…¢
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨è™šæ‹ŸåŒ–æ¸²æŸ“å’Œå»¶è¿ŸåŠ è½½
- **é¢„æœŸæ•ˆæœ**ï¼šåº§ä½å›¾åŠ è½½é€Ÿåº¦æå‡60%

---

## ğŸ”’ 3. å®‰å…¨æ€§è¯„ä¼°

### 3.1 æ•æ„Ÿä¿¡æ¯å¤„ç†

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜13ï¼šç¡¬ç¼–ç æœåŠ¡å™¨åœ°å€**
- **ä½ç½®**ï¼š`data/config.json`
- **é—®é¢˜**ï¼šæœåŠ¡å™¨åœ°å€ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åŠ å¯†é…ç½®
import os
from cryptography.fernet import Fernet

class SecureConfig:
    def __init__(self):
        self.key = os.environ.get('CONFIG_KEY') or self._generate_key()
        self.cipher = Fernet(self.key)
    
    def get_server_url(self):
        encrypted_url = self._load_encrypted_config()
        return self.cipher.decrypt(encrypted_url).decode()
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜é…ç½®å®‰å…¨æ€§

**é—®é¢˜14ï¼šAPIå¯†é’¥æš´éœ²é£é™©**
- **ä½ç½®**ï¼šå¤šä¸ªAPIè°ƒç”¨ç‚¹
- **é—®é¢˜**ï¼štokenå’Œå¯†é’¥å¯èƒ½åœ¨æ—¥å¿—ä¸­æš´éœ²
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šå®ç°æ•æ„Ÿä¿¡æ¯è¿‡æ»¤å™¨
- **é¢„æœŸæ•ˆæœ**ï¼šé˜²æ­¢æ•æ„Ÿä¿¡æ¯æ³„éœ²

### 3.2 è¾“å…¥éªŒè¯

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜15ï¼šç”¨æˆ·è¾“å…¥éªŒè¯ä¸è¶³**
- **ä½ç½®**ï¼šç™»å½•å’Œè¡¨å•è¾“å…¥
- **é—®é¢˜**ï¼šç¼ºå°‘è¾“å…¥æ ¼å¼éªŒè¯å’ŒSQLæ³¨å…¥é˜²æŠ¤
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
import re
from typing import Optional

class InputValidator:
    @staticmethod
    def validate_phone(phone: str) -> bool:
        pattern = r'^1[3-9]\d{9}$'
        return bool(re.match(pattern, phone))
    
    @staticmethod
    def sanitize_input(text: str) -> str:
        # ç§»é™¤æ½œåœ¨å±é™©å­—ç¬¦
        return re.sub(r'[<>"\';]', '', text)
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜è¾“å…¥å®‰å…¨æ€§

---

## ğŸ—ï¸ 4. æ¶æ„å’Œè®¾è®¡æ¨¡å¼

### 4.1 MVCæ¶æ„å®ç°

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜16ï¼šMVCè¾¹ç•Œä¸æ¸…æ™°**
- **ä½ç½®**ï¼šä¸»çª—å£ç±»
- **é—®é¢˜**ï¼šä¸šåŠ¡é€»è¾‘æ··åˆåœ¨UIä»£ç ä¸­
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# åˆ†ç¦»å…³æ³¨ç‚¹
class OrderController:
    def __init__(self, model, view):
        self.model = model
        self.view = view
    
    def create_order(self, order_data):
        # ä¸šåŠ¡é€»è¾‘å¤„ç†
        result = self.model.create_order(order_data)
        self.view.update_order_status(result)

class OrderModel:
    def create_order(self, data):
        # æ•°æ®å¤„ç†é€»è¾‘
        return self.api.create_order(data)

class OrderView:
    def update_order_status(self, result):
        # UIæ›´æ–°é€»è¾‘
        self.status_label.setText(result.status)
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§

### 4.2 ç»„ä»¶è€¦åˆåº¦

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜17ï¼šç»„ä»¶é—´ç´§è€¦åˆ**
- **ä½ç½®**ï¼šå¤šä¸ªWidgetç»„ä»¶
- **é—®é¢˜**ï¼šç»„ä»¶ç›´æ¥ç›¸äº’å¼•ç”¨ï¼Œéš¾ä»¥ç‹¬ç«‹æµ‹è¯•
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ä¾èµ–æ³¨å…¥å’Œæ¥å£æŠ½è±¡
- **é¢„æœŸæ•ˆæœ**ï¼šé™ä½è€¦åˆåº¦ï¼Œæé«˜å¯æµ‹è¯•æ€§

### 4.3 äº‹ä»¶æ€»çº¿ä½¿ç”¨

#### ğŸŸ¢ è‰¯å¥½å®è·µ

**ä¼˜ç‚¹18ï¼šäº‹ä»¶æ€»çº¿è®¾è®¡è‰¯å¥½**
- **ä½ç½®**ï¼š`utils/signals.py`
- **ä¼˜ç‚¹**ï¼šä½¿ç”¨PyQtä¿¡å·å®ç°è§£è€¦é€šä¿¡
- **å»ºè®®**ï¼šç»§ç»­æ‰©å±•äº‹ä»¶æ€»çº¿åŠŸèƒ½

---

## ğŸ”§ 5. å¯ç»´æŠ¤æ€§

### 5.1 é…ç½®ç®¡ç†

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜19ï¼šé…ç½®åˆ†æ•£**
- **ä½ç½®**ï¼šå¤šä¸ªé…ç½®æ–‡ä»¶
- **é—®é¢˜**ï¼šé…ç½®ä¿¡æ¯åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šç»Ÿä¸€é…ç½®ç®¡ç†
```python
class ConfigManager:
    def __init__(self):
        self.config = self._load_all_configs()
    
    def _load_all_configs(self):
        # åˆå¹¶æ‰€æœ‰é…ç½®æ–‡ä»¶
        return {
            'server': self._load_server_config(),
            'ui': self._load_ui_config(),
            'api': self._load_api_config()
        }
```
- **é¢„æœŸæ•ˆæœ**ï¼šç®€åŒ–é…ç½®ç®¡ç†

### 5.2 æ—¥å¿—è®°å½•

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜20ï¼šæ—¥å¿—ç³»ç»Ÿä¸å®Œå–„**
- **ä½ç½®**ï¼šå…¨é¡¹ç›®
- **é—®é¢˜**ï¼šä½¿ç”¨printè¯­å¥è€Œéæ ‡å‡†æ—¥å¿—
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
import logging
from logging.handlers import RotatingFileHandler

class LoggerSetup:
    @staticmethod
    def setup_logger(name: str) -> logging.Logger:
        logger = logging.getLogger(name)
        logger.setLevel(logging.INFO)
        
        # æ–‡ä»¶å¤„ç†å™¨
        file_handler = RotatingFileHandler(
            f'logs/{name}.log', 
            maxBytes=10*1024*1024,  # 10MB
            backupCount=5
        )
        
        # æ ¼å¼åŒ–å™¨
        formatter = logging.Formatter(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        )
        file_handler.setFormatter(formatter)
        logger.addHandler(file_handler)
        
        return logger
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜é—®é¢˜è¯Šæ–­èƒ½åŠ›

### 5.3 æµ‹è¯•è¦†ç›–ç‡

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜21ï¼šç¼ºå°‘å•å…ƒæµ‹è¯•**
- **ä½ç½®**ï¼šå…¨é¡¹ç›®
- **é—®é¢˜**ï¼šæ²¡æœ‰å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šå»ºç«‹æµ‹è¯•æ¡†æ¶
```python
import unittest
from unittest.mock import Mock, patch

class TestOrderAPI(unittest.TestCase):
    def setUp(self):
        self.api = OrderAPI()
    
    @patch('requests.post')
    def test_create_order_success(self, mock_post):
        mock_post.return_value.json.return_value = {
            'resultCode': '0',
            'resultData': {'orderno': '123'}
        }
        
        result = self.api.create_order({'test': 'data'})
        self.assertEqual(result['resultCode'], '0')
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜ä»£ç è´¨é‡å’Œç¨³å®šæ€§

---

## ğŸ“¦ 6. æ‰“åŒ…å’Œéƒ¨ç½²

### 6.1 æ‰“åŒ…é…ç½®ä¼˜åŒ–

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜22ï¼šæ‰“åŒ…ä½“ç§¯è¿‡å¤§**
- **ä½ç½®**ï¼š`build_exe.py`
- **é—®é¢˜**ï¼šåŒ…å«ä¸å¿…è¦çš„ä¾èµ–
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šä¼˜åŒ–excludesåˆ—è¡¨å’Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘æ‰“åŒ…ä½“ç§¯30%

### 6.2 ä¾èµ–ç®¡ç†

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜23ï¼šä¾èµ–ç‰ˆæœ¬ä¸å›ºå®š**
- **ä½ç½®**ï¼š`requirements.txt`
- **é—®é¢˜**ï¼šéƒ¨åˆ†ä¾èµ–æ²¡æœ‰æŒ‡å®šå…·ä½“ç‰ˆæœ¬
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨pip freezeå›ºå®šç‰ˆæœ¬
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜éƒ¨ç½²ç¨³å®šæ€§

---

## ğŸ”§ 7. å…·ä½“ä»£ç é—®é¢˜è¯¦è§£

### 7.1 å·¥å…·ç±»ä»£ç è´¨é‡é—®é¢˜

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜24ï¼šäºŒç»´ç ç”Ÿæˆå™¨è¿‡åº¦å¤æ‚**
- **ä½ç½®**ï¼š`utils/qrcode_generator.py:21-94`
- **é—®é¢˜**ï¼š`ensure_qrcode_import()` å‡½æ•°åŒ…å«4ç§å¯¼å…¥ç­–ç•¥ï¼Œè¿‡åº¦å¤æ‚
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# ç®€åŒ–ç‰ˆæœ¬
def ensure_qrcode_import():
    """ç®€åŒ–çš„qrcodeå¯¼å…¥æ£€æŸ¥"""
    global QRCODE_AVAILABLE, qrcode

    if QRCODE_AVAILABLE is not None:
        return QRCODE_AVAILABLE, qrcode

    try:
        import qrcode as qr_module
        QRCODE_AVAILABLE = True
        qrcode = qr_module
        return True, qr_module
    except ImportError:
        QRCODE_AVAILABLE = False
        qrcode = None
        return False, None
```
- **é¢„æœŸæ•ˆæœ**ï¼šå‡å°‘ä»£ç å¤æ‚åº¦70%ï¼Œæé«˜å¯ç»´æŠ¤æ€§

**é—®é¢˜25ï¼šå…¨å±€å˜é‡ä½¿ç”¨ä¸å½“**
- **ä½ç½®**ï¼š`utils/qrcode_generator.py:15-16`
- **é—®é¢˜**ï¼šä½¿ç”¨å…¨å±€å˜é‡å­˜å‚¨çŠ¶æ€
```python
# é—®é¢˜ä»£ç 
QRCODE_AVAILABLE = None
qrcode = None
```
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–ç±»å±æ€§
```python
class QRCodeManager:
    _instance = None
    _qrcode_available = None
    _qrcode_module = None

    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance

    def is_available(self):
        if self._qrcode_available is None:
            self._check_qrcode_availability()
        return self._qrcode_available
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜çº¿ç¨‹å®‰å…¨æ€§å’Œä»£ç ç»„ç»‡

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜26ï¼šäº‹ä»¶æ€»çº¿è®¾è®¡è‰¯å¥½ä½†ç¼ºå°‘æ–‡æ¡£**
- **ä½ç½®**ï¼š`utils/signals.py:15-79`
- **é—®é¢˜**ï¼šäº‹ä»¶æ€»çº¿è®¾è®¡è‰¯å¥½ï¼Œä½†ç¼ºå°‘ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹
- **ä¸¥é‡ç¨‹åº¦**ï¼šä½
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²å’Œä½¿ç”¨ç¤ºä¾‹
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜å¼€å‘æ•ˆç‡

### 7.2 UIç»„ä»¶ä»£ç è´¨é‡

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜27ï¼šUIç»„ä»¶èŒè´£ä¸æ¸…**
- **ä½ç½®**ï¼š`ui/widgets/account_widget.py:222-249`
- **é—®é¢˜**ï¼šUIç»„ä»¶ç›´æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘
```python
# é—®é¢˜ä»£ç ï¼šUIç»„ä»¶ä¸­çš„ä¸šåŠ¡é€»è¾‘
def _on_submit_order(self):
    order_data = {
        "order_id": f"ORDER{int(__import__('time').time())}",
        "amount": len(self.selected_seats) * 35.0,  # ç¡¬ç¼–ç ä»·æ ¼
    }
```
- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­ç­‰
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ†ç¦»UIå’Œä¸šåŠ¡é€»è¾‘
```python
# æ”¹è¿›åï¼šä½¿ç”¨æ§åˆ¶å™¨æ¨¡å¼
class OrderController:
    def create_order(self, seats, movie_info):
        price_calculator = PriceCalculator()
        amount = price_calculator.calculate(seats, movie_info)
        return OrderService.create_order({
            "seats": seats,
            "amount": amount
        })

class AccountWidget(QWidget):
    def _on_submit_order(self):
        result = self.controller.create_order(
            self.selected_seats,
            self.current_movie
        )
        self._handle_order_result(result)
```
- **é¢„æœŸæ•ˆæœ**ï¼šæé«˜å¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§

### 7.3 APIå±‚ä»£ç è´¨é‡

#### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

**é—®é¢˜28ï¼šAPIé”™è¯¯å¤„ç†ä¸ä¸€è‡´**
- **ä½ç½®**ï¼š`services/order_api.py:477-499`
- **é—®é¢˜**ï¼šä¸åŒAPIå‡½æ•°çš„é”™è¯¯å¤„ç†æ–¹å¼ä¸ä¸€è‡´
- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºç»Ÿä¸€çš„APIåŸºç±»
```python
class BaseAPI:
    def __init__(self, base_url, timeout=10):
        self.base_url = base_url
        self.timeout = timeout
        self.logger = logging.getLogger(self.__class__.__name__)

    def _make_request(self, method, endpoint, **kwargs):
        """ç»Ÿä¸€çš„è¯·æ±‚å¤„ç†"""
        try:
            url = f"{self.base_url}/{endpoint}"
            response = requests.request(method, url, timeout=self.timeout, **kwargs)

            if response.status_code == 200:
                return self._parse_response(response)
            else:
                return self._handle_http_error(response)

        except requests.exceptions.RequestException as e:
            return self._handle_network_error(e)

    def _parse_response(self, response):
        """è§£æå“åº”"""
        try:
            return response.json()
        except ValueError:
            return {"resultCode": "-1", "resultDesc": "å“åº”æ ¼å¼é”™è¯¯"}

    def _handle_http_error(self, response):
        """å¤„ç†HTTPé”™è¯¯"""
        return {
            "resultCode": str(response.status_code),
            "resultDesc": f"HTTPé”™è¯¯: {response.status_code}"
        }

    def _handle_network_error(self, error):
        """å¤„ç†ç½‘ç»œé”™è¯¯"""
        self.logger.error(f"ç½‘ç»œé”™è¯¯: {error}")
        return {"resultCode": "-1", "resultDesc": "ç½‘ç»œè¿æ¥å¤±è´¥"}
```
- **é¢„æœŸæ•ˆæœ**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œå‡å°‘ä»£ç é‡å¤80%

---

## ğŸ“‹ å®æ–½ä¼˜å…ˆçº§æ’åº

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å¤„ç†ï¼‰
1. **å¼‚å¸¸å¤„ç†æ¨¡å¼é‡å¤** - å½±å“ä»£ç è´¨é‡
2. **é‡å¤APIè°ƒç”¨** - å½±å“æ€§èƒ½
3. **ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯** - å®‰å…¨é£é™©
4. **æ—¥å¿—ç³»ç»Ÿä¸å®Œå–„** - å½±å“ç»´æŠ¤
5. **ç¼ºå°‘å•å…ƒæµ‹è¯•** - å½±å“ç¨³å®šæ€§
6. **äºŒç»´ç ç”Ÿæˆå™¨è¿‡åº¦å¤æ‚** - ç»´æŠ¤å›°éš¾
7. **APIé”™è¯¯å¤„ç†ä¸ä¸€è‡´** - ç”¨æˆ·ä½“éªŒ

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆ1-2å‘¨å†…å¤„ç†ï¼‰
8. **ç±»å‹æ³¨è§£ä¸å®Œæ•´** - å½±å“å¯ç»´æŠ¤æ€§
9. **MVCè¾¹ç•Œä¸æ¸…æ™°** - æ¶æ„é—®é¢˜
10. **é…ç½®ç®¡ç†åˆ†æ•£** - ç»´æŠ¤é—®é¢˜
11. **è¾“å…¥éªŒè¯ä¸è¶³** - å®‰å…¨é—®é¢˜
12. **æ‰“åŒ…ä½“ç§¯ä¼˜åŒ–** - ç”¨æˆ·ä½“éªŒ
13. **UIç»„ä»¶èŒè´£ä¸æ¸…** - æ¶æ„é—®é¢˜
14. **å…¨å±€å˜é‡ä½¿ç”¨ä¸å½“** - ä»£ç è´¨é‡

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰
15. **æœªä½¿ç”¨å¯¼å…¥æ¸…ç†** - ä»£ç æ¸…æ´
16. **UIå“åº”æ€§ä¼˜åŒ–** - ç”¨æˆ·ä½“éªŒ
17. **å†…å­˜ä½¿ç”¨ä¼˜åŒ–** - æ€§èƒ½æå‡
18. **äº‹ä»¶æ€»çº¿æ–‡æ¡£å®Œå–„** - å¼€å‘ä½“éªŒ

---

## ğŸ“Š æ€»ä½“è¯„ä¼°

**ä»£ç è´¨é‡è¯„åˆ†**ï¼š6.2/10
**æ¶æ„è®¾è®¡è¯„åˆ†**ï¼š6.8/10
**å®‰å…¨æ€§è¯„åˆ†**ï¼š5.5/10
**å¯ç»´æŠ¤æ€§è¯„åˆ†**ï¼š6.0/10
**æ€§èƒ½è¯„åˆ†**ï¼š6.5/10

**æ€»ä½“è¯„åˆ†**ï¼š6.2/10

### ğŸ¯ æ”¹è¿›å»ºè®®

#### ç«‹å³è¡ŒåŠ¨ï¼ˆæœ¬å‘¨å†…ï¼‰
1. **å®æ–½ç»Ÿä¸€å¼‚å¸¸å¤„ç†è£…é¥°å™¨**
2. **å»ºç«‹æ ‡å‡†æ—¥å¿—ç³»ç»Ÿ**
3. **ç®€åŒ–äºŒç»´ç ç”Ÿæˆå™¨é€»è¾‘**
4. **åˆ›å»ºAPIåŸºç±»ç»Ÿä¸€é”™è¯¯å¤„ç†**

#### çŸ­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰
1. **å®Œå–„ç±»å‹æ³¨è§£è¦†ç›–ç‡åˆ°80%**
2. **å»ºç«‹å•å…ƒæµ‹è¯•æ¡†æ¶**
3. **é‡æ„UIç»„ä»¶åˆ†ç¦»ä¸šåŠ¡é€»è¾‘**
4. **å®æ–½é…ç½®ç®¡ç†ç»Ÿä¸€åŒ–**

#### ä¸­æœŸè§„åˆ’ï¼ˆ3ä¸ªæœˆå†…ï¼‰
1. **é‡æ„MVCæ¶æ„è¾¹ç•Œ**
2. **ä¼˜åŒ–APIè°ƒç”¨ç¼“å­˜æœºåˆ¶**
3. **å®Œå–„è¾“å…¥éªŒè¯ä½“ç³»**
4. **å»ºç«‹CI/CDæµç¨‹**

#### é•¿æœŸæ„¿æ™¯ï¼ˆ6ä¸ªæœˆå†…ï¼‰
1. **å»ºç«‹å®Œæ•´çš„æµ‹è¯•è¦†ç›–ç‡ï¼ˆ80%+ï¼‰**
2. **å®æ–½æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–**
3. **å»ºç«‹ä»£ç è´¨é‡é—¨ç¦**
4. **å®Œå–„æ–‡æ¡£å’Œå¼€å‘æŒ‡å—**

---

## ğŸ› ï¸ å…·ä½“å®æ–½è®¡åˆ’

### ç¬¬ä¸€å‘¨ï¼šåŸºç¡€è®¾æ–½å»ºè®¾
- [ ] å®æ–½ç»Ÿä¸€å¼‚å¸¸å¤„ç†è£…é¥°å™¨
- [ ] å»ºç«‹æ—¥å¿—ç³»ç»Ÿ
- [ ] åˆ›å»ºAPIåŸºç±»
- [ ] ç®€åŒ–äºŒç»´ç ç”Ÿæˆå™¨

### ç¬¬äºŒå‘¨ï¼šä»£ç è´¨é‡æå‡
- [ ] æ·»åŠ ç±»å‹æ³¨è§£ï¼ˆæ ¸å¿ƒæ¨¡å—ï¼‰
- [ ] å»ºç«‹å•å…ƒæµ‹è¯•æ¡†æ¶
- [ ] é‡æ„é‡å¤ä»£ç 
- [ ] ä¼˜åŒ–å¯¼å…¥è¯­å¥

### ç¬¬ä¸‰å‘¨ï¼šæ¶æ„ä¼˜åŒ–
- [ ] åˆ†ç¦»UIå’Œä¸šåŠ¡é€»è¾‘
- [ ] ç»Ÿä¸€é…ç½®ç®¡ç†
- [ ] ä¼˜åŒ–äº‹ä»¶æ€»çº¿ä½¿ç”¨
- [ ] å®Œå–„é”™è¯¯å¤„ç†

### ç¬¬å››å‘¨ï¼šå®‰å…¨å’Œæ€§èƒ½
- [ ] å®æ–½è¾“å…¥éªŒè¯
- [ ] ä¼˜åŒ–APIè°ƒç”¨
- [ ] åŠ å¼ºæ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- [ ] æ€§èƒ½ç“¶é¢ˆåˆ†æ

---

*åˆ†æå®Œæˆæ—¶é—´ï¼š2024å¹´12æœˆ*
*ä¸‹æ¬¡è¯„ä¼°å»ºè®®ï¼š1ä¸ªæœˆåï¼ˆè·Ÿè¸ªæ”¹è¿›è¿›åº¦ï¼‰*
